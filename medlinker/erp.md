# ERP对接文档
## 对码
### 对码原则
* 规则：本位码+批准文号+通用名+生产厂家
### 对码字段
| 字段名        | 中文列名   |  数据类型  | 是否必填 | 备注 |
| :--------:   | :-----:  | :----:  | :---------: | :-------: |
| standard_code        |   药品本位码   |   varchar(256)   | 是 | 14位标准(请参照国家标准) |
| generic_name | 药品通用名 | varchar(100) | 是 | - |
| approval_number | 批准文号 | varchar(20) | 是 | - |
| manufacturer_title | 生产单位 | varchar(100) | 是 | - |

## API文档
### 鉴权方式
对于ERP发起的接口，使用医联签发的token发起http调用。
在http header中使用medlinker_erp_token字段提交token。

> 注意: 此token不可泄露
### 协议格式
使用https协议作为交互协议。
其中http状态码作为协议握手状态码，如果http状态码为200则会继续检查下面响应格式中的status字段(逻辑状态码)。
#### 请求格式
请求格式按照约定的json格式提交数据
#### 响应格式
```
{
    "code": 0, // 0 响应正常 非0 则对应错误码
    "message": "error message", // code不为0时展示
    "data": ""              // 数据字段，保存的是下面响应格式的字符串，如果没有，则为空字符串
}
```
### 货品主数据对码
#### 请求格式
```
{
    "standard_code": "1234",
    "generic_name": "药品通用名",
    "approval_number": "批准文号",
    "manufacturer_title": "生产单位",

    "goods_id": 1111,                       // erp内的货品id 必填
    "erp_specification": "规格字符串",      // erp货品规格 必填
    "base_unit": "基本单位"                 // erp的药品基本单位 必填
}
```
#### 响应格式中数据字段
```
{
}
```
### 库存同步
#### 请求格式
```
{
    "erp_store_id": "1234",             // erp内的药店id            必填 类型: 字符串
    "goods_id": 1111,                   // erp内货品id              必填 类型: 整型
    "entry_goods_id": 2222,             // erp内独立货品id         必填 类型: 整型
    "stock": 10000                      // 库存                    必填 类型: 整型
}
```
#### 响应格式中数据字段
```
{
}
```
### 零售价格同步
#### 请求格式
```
{
    "erp_store_id": "1234",             // erp内的药店id            必填 类型: 字符串
    "goods_id": 1111,                   // erp内货品id              必填 类型: 整型
    "entry_goods_id": 2222,             // erp内独立货品id          必填 类型: 整型
    "sale_price": 10000                 // 销售价格(单位: 分)       必填 类型: 整型
}
```
#### 响应格式中数据字段
```
{
}
```

### 药店首营
#### 请求格式
```
{
    "erp_store_id": "1234",             // erp内的药店id                必填 类型: 字符串
    "goods_id": 1111,                   // erp内货品id                  必填 类型: 整型
    "entry_goods_id": 2222,             // erp内独立货品id              必填 类型: 整型
    "status": -1                        // 上下架状态 -1 下架 1 上架    必填 类型: 整型
    "stock": 100,                       // 库存                         必填 类型: 整型
    "sale_price": 1000,                 // 销售价格(单位: 分)           必填 类型: 整型
}
```
#### 响应格式中数据字段
```
{
}
```

> 注意: 首营的时候没有传递药品价格和库存，医联方需要实现没有价格的sku即使是上架状态也不允许售卖
